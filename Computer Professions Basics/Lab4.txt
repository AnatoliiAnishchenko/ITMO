;008 - cur element
;009 - counter

ORG 008
CUR:	WORD	?	#current element
CNT:	WORD	?	#counter

ORG	050
LINK:	WORD	0300
N:	WORD	0009
RES:	WORD	?

ARG:	WORD	?

ORG	300	#Array
	WORD	0004
	WORD	0005
	WORD	8000
	WORD	0004
	WORD	C000
	WORD	00F9
	WORD	C000
	WORD	0005
	WORD	8000

ORG	7EA

PUSH:	WORD 	?
	MOV	(ADDRES)
	CLA
	ADD	ADDRES
	DEC
	MOV	ADDRES
	ISZ	COUNT
	NOP
	BR	(PUSH)

POP:	WORD	?
	CLA
	ADD	COUNT
	BEQ	(POP)
	DEC
	MOV	COUNT
	ISZ	ADDRES
	NOP
	CLA
	ADD	(ADDRES)
	BR	(POP)

ADDRES:	WORD	07E9
COUNT:	WORD	0000

ORG	100

BEGIN:	CLA
	CLC
	ADD	LINK
	MOV	CUR
	CLA
	ADD	N
	CMA
	INC
	MOV	CNT
LOOP:	CLA
	ADD	(CUR)
	BMI	SIGN	#if sign 	
	BR	NUM	#if num				
ELOOP:	ISZ	CNT
	BR 	LOOP
	JSR	POP
	MOV	RES	
	HLT

SIGN:	ROL
	CLC	
	BEQ	PLUS
	BMI	MINUS
PLUS:	JSR	POP
	MOV	ARG
	CLA	
	JSR	POP
	ADD	ARG
	JSR	PUSH
	BR	ELOOP
MINUS:	JSR	POP
	MOV	ARG
	CLA	
	JSR	POP
	SUB	ARG
	JSR	PUSH
	BR	ELOOP

NUM:	ROL
	ROL
	ROL
	ROL
	ROL
	ROL
	ROL
	ROL
	BMI	NUMMI
	ROR
	ROR
	ROR
	ROR
	ROR
	ROR
	ROR
	ROR
	BR	ENUM
NUMMI:	CMC
	ROR
	CMC
	ROR
	CMC
	ROR
	CMC
	ROR
	CMC
	ROR
	CMC
	ROR
	CMC
	ROR
	CMC
	ROR
ENUM:	JSR	PUSH
	BR	ELOOP
